#include "avtp.h"

// Define logging tag
static const char *TAG = "AVTP";

////////////
// MSRP, MVRP and AVTP messages
////////////

// Test msrp domain
static uint8_t msrp_domain[] = {
    0x00, // protocol version
    0x04, // attribute type: domain (4)
    0x04, // attribute length: 4
    0x00,0x09, // attribute list length: 9
    0x20,0x01, // vector header: 0x2001 (leave all, number of values: 1)
    0x06, // sr class ID: sr class A (6)
    0x03, // sr class priority: 3
    0x00,0x02, // sr class VID: 2
    0x24, // attribute event: JoinIn (1)
    0x00,0x00, // end mark for list
    0x04, // attribute type: domain (4)
    0x04, // attribute length: 4
    0x00,0x09, // attribute list length: 9
    0x00,0x01, // vector header: 0x0001 (leave all: null, number of values: 1)
    0x05, // sr class ID: sr class B (5)
    0x02, // sr class priority: 2
    0x00,0x02, // sr class VID: 2
    0x24, // attribute event: JoinIn (1)
    0x00,0x00, // end mark for list
    0x00,0x00, // end mark for pdu
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // padding
    0x00,0x00,0x00,0x00,0x00 // padding
}; // 50 bytes

// Test msrp talker advertise
static uint8_t msrp_talker_advertise[] = {
    0x00, // protocol version
    0x01, // attribute type: talker advertise (1)
    0x19, // attribute length: 25
    0x00,0x1d, // attribute list length: 29
    0x20,0x00, // vector header: 0x2000
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // stream id: 0
    0x00,0x00,0x00,0x00,0x00,0x00, // stream da: 00:00:00:00:00:00
    0x00,0x00, // vlan id: 0
    0x00,0x00, // tspec max frame size: 0
    0x00,0x00, // tspec max frame interval: 0
    0x00, // priority: unknown (0), rank: emergency (0), reserved: 0
    0x00,0x00,0x00,0x00, // accumulated latency:0
    0x00,0x00, // end mark for list
    0x00,0x00, // end mark for pdu
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 // padding
}; // 50 bytes

// Test msrp listener
static uint8_t msrp_listener[] = {
    0x00, // protocol version
    0x03, // attribute type: listener (3)
    0x08, // attribute length: 8
    0x00,0x0c, // attribute list length: 12
    0x20,0x00, // vector header: 0x2000
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // stream id: 0
    0x00,0x00, // end mark for list
    0x00,0x00, // end mark for pdu
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // padding
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 // padding
}; // 50 bytes

////////////
// MAAP message example (based on Apple)
////////////

// Test maap announce
static uint8_t maap_announce[] = {
    0xfe, // avtp subtype: MAAP (0xfe)
    0x03, // stream id value: false, avtp version: 0x0, msg type: maap_announce (0x3)
    0x08,0x10, // maap version: 0x01, data length: 0x010
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // stream id: 0
    0x91,0xe0,0xf0,0x00,0x3b,0xc0, // requested start addr: 1722-bcast
    0x00,0x40, // request count: 0x0040
    0x00,0x00,0x00,0x00,0x00,0x00, // conflict start addr: 00:00:00:00:00:00
    0x00,0x00, // conflict count: 0
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // padding
    0x00,0x00 // padding
}; // 46 bytes

////////////
// MVRP message example
////////////

// Test mvrp vlan identifier
static uint8_t mvrp_vlan_identifier[] = {
    0x00, // protocol version
    0x01, // attribute type: vlan identifier (1)
    0x02, // attribute length: 2
    0x00,0x01, // vector header: 0x0001 (leave all event: null, number of values: 1)
    0x00,0x02, // vlan id: 2
    0x24, // attribute event: JoinIn (1)
    0x00,0x00, // end mark of list
    0x00,0x00, // end mark of pdu
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // padding
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // padding
    0x00,0x00,0x00,0x00,0x00,0x00 // padding
}; // 50 bytes